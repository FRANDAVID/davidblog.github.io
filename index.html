<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home //首页 fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags //标签 fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th //分类 fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive //归档 fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2029/10/11/Oracle%E6%AD%BB%E9%94%81%E6%A3%80%E6%B5%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2029/10/11/Oracle%E6%AD%BB%E9%94%81%E6%A3%80%E6%B5%8B/" class="post-title-link" itemprop="url">Oracles死锁检测</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2029-10-11 17:23:00" itemprop="dateCreated datePublished" datetime="2029-10-11T17:23:00+08:00">2029-10-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 17:21:50" itemprop="dateModified" datetime="2020-10-11T17:21:50+08:00">2020-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="检测oracle锁情况"><a href="#检测oracle锁情况" class="headerlink" title="检测oracle锁情况"></a>检测oracle锁情况</h3><hr>
<pre><code>select
mm.addr
  , mm.kaddr
  , mm.sid
  , row_number() over (partition by mm.type,mm.id1,mm.id2 order by mm.lmode desc ,mm.ctime desc) resource_row_number
  , mm.type
  , mm.id1
  , mm.id2
  , decode(mm.lmode, 0, null, 1, &#39;N&#39;, 2, &#39;SS|RS&#39;, 3, &#39;SX|RX&#39;, 4, &#39;S&#39;, 5, &#39;SSX|SRX&#39;, 6, &#39;X&#39;) lmode
  , decode(mm.request, 0, null, 1, &#39;N&#39;, 2, &#39;SS|RS&#39;, 3, &#39;SX|RX&#39;, 4, &#39;S&#39;, 5, &#39;SSX|SRX&#39;, 6, &#39;X&#39;) request
--  , mm.ctime
  , lpad(trunc(mm.ctime/60/60),3) || &#39; Hour &#39;
    || lpad(to_char(trunc(mm.ctime/60) - trunc(mm.ctime/60/60) * 60,&#39;fm09&#39;), 2) || &#39; Min &#39;
    || lpad(to_char(mm.ctime - trunc(mm.ctime/60)*60,&#39;fm09&#39;), 2) || &#39; Sec&#39; ctime
  , case when mm.block = 1 and mm.lmode != 0 then &#39;holder&#39;
         when mm.block = 0 and mm.request != 0 then &#39;waiter&#39;
         else null end role
  , case when ee.blocking_session is not null then &#39;waiting for SID &#39;|| ee.blocking_session else null end blocking_session
  , dd.sql_text sql_text
  , cc.event wait_event
from
    v$lock mm
  , v$session ee
  , v$sqlarea dd
  , v$session_wait cc
where mm.sid in (
                select nn.sid
                from (
                  select
                      tt.*
                    , count(1) over (partition by  tt.type,tt.id1,tt.id2) cnt
                    , max(tt.lmode) over (partition by tt.type,tt.id1,tt.id2) lmod_flag
                    , max(tt.request) over (partition by tt.type,tt.id1,tt.id2) request_flag
                  from v$lock tt ) nn
                where nn.cnt &gt; 1
                  and nn.lmod_flag != 0
                  and nn.request_flag != 0)
  and mm.sid = ee.sid(+)
  and ee.sql_id = dd.sql_id(+)
  and mm.sid = cc.sid(+)
order by mm.type, mm.id1, mm.id2,mm.lmode desc ,mm.ctime desc;</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/15/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/15/%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%91%BD%E4%BB%A4/" class="post-title-link" itemprop="url">服务器常用命令</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-10-15 00:00:00 / Modified: 15:00:52" itemprop="dateCreated datePublished" datetime="2020-10-15T00:00:00+08:00">2020-10-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%91%BD%E4%BB%A4/" itemprop="url" rel="index"><span itemprop="name">命令</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="常用服务器命令"><a href="#常用服务器命令" class="headerlink" title="常用服务器命令"></a>常用服务器命令</h2><ul>
<li>查询各个tcp状态个数</li>
</ul>
<pre><code>netstat -nat |awk &#39;&#123;print $6&#125;&#39;|sort|uniq -c</code></pre>
<p>##<br>            [root@ID-APP-USS-013 logs]# netstat -nat |awk ‘{print $6}’|sort|uniq -c<br>            363 CLOSE_WAIT<br>          1 established)<br>          249 ESTABLISHED<br>          1 Foreign<br>          16 LISTEN<br>          3991 TIME_WAIT</p>
<ul>
<li>显示网络接口列表</li>
</ul>
<pre><code>#netstat -ie

eth0      Link encap:Ethernet  HWaddr 70:E2:84:0F:41:F5  
      inet addr:172.25.123.38  Bcast:172.25.123.255  Mask:255.255.255.0
      UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
      RX packets:109855651084 errors:0 dropped:0 overruns:0 frame:0
      TX packets:122090496157 errors:0 dropped:0 overruns:0 carrier:0
      collisions:0 txqueuelen:1000 
      RX bytes:52418855858816 (47.6 TiB)  TX bytes:37916432750602 (34.4 TiB)
      Memory:dfc20000-dfc40000 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:170746817 errors:0 dropped:0 overruns:0 frame:0
          TX packets:170746817 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:41975651381 (39.0 GiB)  TX bytes:41975651381 (39.0 GiB)</code></pre>
<ul>
<li>找出程序运行的端口</li>
</ul>
<pre><code>netstat -ap | grep sshnetstat -ap | grep java

[root@ID-APP-USS-013 logs]# netstat -ap | grep java
tcp        0      0 localhost:6005              *:*                         LISTEN      209764/java         
tcp        0      0 localhost:6007              *:*                         LISTEN      210019/java         
tcp        0      0 localhost:6008              *:*                         LISTEN      194550/java         
tcp        0      0 *:afs3-callback             *:*                         LISTEN      210657/java         
tcp        0      0 localhost:afs3-volser       *:*                         LISTEN      217184/java         
tcp        0      0 *:6080                      *:*                         LISTEN      216748/java         
tcp        0      0 *:6081                      *:*                         LISTEN      217184/java         
tcp        0      0 localhost:mxi               *:*                         LISTEN      216748/java         
tcp        0      0 *:6181                      *:*                         LISTEN      210019/java         
tcp        0      0 *:6182                      *:*                         LISTEN      209764/java         
tcp        0      0 *:8009                      *:*                         LISTEN      194550/java         
tcp        0      0 *:6185                      *:*                         LISTEN      194550/java         
tcp        0      0 ID-APP-USS-013:21016        172.25.123.:afs3-fileserver ESTABLISHED 217184/java         
tcp        1      0 ID-APP-USS-013:57626        uss-int.lenovomm.com:https  CLOSE_WAIT  210019/java         
tcp        0      0 ID-APP-USS-013:15882        zoo.kafka.2:XmlIpcRegSvc    ESTABLISHED 210019/java         
tcp        1      0 ID-APP-USS-013:48046        uss-int.lenovomm.com:https  CLOSE_WAIT  209764/java         
tcp        1      0 ID-APP-USS-013:55106        uss-int.lenovomm.com:https  CLOSE_WAIT  209764/java         
tcp        1      0 ID-APP-USS-013:28537        140.207.119.12:https        CLOSE_WAIT  216748/java         
tcp        0      0 ID-APP-USS-013:38033        uss-int.lenovomm.com:https  ESTABLISHED 209764/java         
tcp        1      0 ID-APP-USS-013:12630        uss-int.lenovomm.com:https  CLOSE_WAIT  209764/java         
tcp       32      0 ID-APP-USS-013:33068        dns242.online.tj.cn:https   CLOSE_WAIT  210019/java         
tcp        1      0 ID-APP-USS-013:13013        uss-int.lenovomm.com:https  CLOSE_WAIT  209764/java         
tcp        1      0 ID-APP-USS-013:10012        uss-int.lenovomm.com:https  CLOSE_WAIT  209764/java         
tcp        1      0 ID-APP-USS-013:18273        uss-int.lenovomm.com:https  CLOSE_WAIT  209764/java         
tcp       32      0 ID-APP-USS-013:14793        180.149.135.176:https       CLOSE_WAIT  210019/java         
tcp        1      0 ID-APP-USS-013:59054        uss-int.lenovomm.com:https  CLOSE_WAIT  209764/java         
tcp        1      0 ID-APP-USS-013:22327        140.207.119.12:https        CLOSE_WAIT  217184/java         
tcp        0      0 ID-APP-USS-013:14528        172.25.123.:afs3-fileserver ESTABLISHED 209764/java         
tcp        0      0 ID-APP-USS-013:64616        zoo.kafka.1:XmlIpcRegSvc    ESTABLISHED 217184/java         
tcp        1      0 ID-APP-USS-013:45071        uss-int.lenovomm.com:https  CLOSE_WAIT  209764/java         
tcp       32      0 ID-APP-USS-013:37568        dns242.online.tj.cn:https   CLOSE_WAIT  217184/java         
tcp        0      0 ID-APP-USS-013:65088        zoo.kafka.1:XmlIpcRegSvc    ESTABLISHED 217184/java         
tcp        1      0 ID-APP-USS-013:45106        uss-int.lenovomm.com:https  CLOSE_WAIT  209764/java         </code></pre>
<ul>
<li><p>对特定端口进行抓包</p>
<p>  tcpdump host 172.25.123.34 |grep 6080</p>
</li>
</ul>
<pre><code>tcpdump -i eth0 tcp port 
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes
17:40:22.394966 IP ID-APP-USS-013.6080 &gt; 172.25.123.34.7310: Flags [P.], seq 2277545763:2277546475, ack 1539290364, win 31, length 712
17:40:22.395078 IP 172.25.123.34.7310 &gt; ID-APP-USS-013.6080: Flags [.], ack 712, win 15, length 0
17:40:22.395198 IP ID-APP-USS-013.6080 &gt; 172.25.123.34.7310: Flags [F.], seq 712, ack 1, win 31, length 0
17:40:22.395308 IP 172.25.123.34.7310 &gt; ID-APP-USS-013.6080: Flags [F.], seq 1, ack 713, win 15, length 0
17:40:22.395316 IP ID-APP-USS-013.6080 &gt; 172.25.123.34.7310: Flags [.], ack 2, win 31, length 0
17:40:23.440149 IP 172.25.123.34.8231 &gt; ID-APP-USS-013.6080: Flags [S], seq 2040062584, win 5840, options [mss 1460,nop,nop,sackOK,nop,wscale 9], length 0
17:40:23.440181 IP ID-APP-USS-013.6080 &gt; 172.25.123.34.8231: Flags [S.], seq 148350741, ack 2040062585, win 14600, options [mss 1460,nop,nop,sackOK,nop,wscale 9], length 0
17:40:23.440286 IP 172.25.123.34.8231 &gt; ID-APP-USS-013.6080: Flags [.], ack 1, win 12, length 0
17:40:23.440296 IP 172.25.123.34.8231 &gt; ID-APP-USS-013.6080: Flags [P.], seq 1:450, ack 1, win 12, length 449
17:40:23.440300 IP ID-APP-USS-013.6080 &gt; 172.25.123.34.8231: Flags [.], ack 450, win 31, length 0
17:40:23.452163 IP ID-APP-USS-013.6080 &gt; 172.25.123.34.8231: Flags [P.], seq 1:233, ack 450, win 31, length 232
17:40:23.452269 IP 172.25.123.34.8231 &gt; ID-APP-USS-013.6080: Flags [.], ack 233, win 14, length 0
17:40:23.452308 IP ID-APP-USS-013.6080 &gt; 172.25.123.34.8231: Flags [F.], seq 233, ack 450, win 31, length 0
17:40:23.452411 IP 172.25.123.34.8231 &gt; ID-APP-USS-013.6080: Flags [F.], seq 450, ack 234, win 14, length 0
17:40:23.452418 IP ID-APP-USS-013.6080 &gt; 172.25.123.34.8231: Flags [.], ack 451, win 31, length 0
17:40:24.613238 IP 172.25.123.34.8726 &gt; ID-APP-USS-013.6080: Flags [S], seq 2623952161, win 5840, options [mss 1460,nop,nop,sackOK,nop,wscale 9], length 0
17:40:24.613271 IP ID-APP-USS-013.6080 &gt; 172.25.123.34.8726: Flags [S.], seq 335918990, ack 2623952162, win 14600, options [mss 1460,nop,nop,sackOK,nop,wscale 9], length 0
17:40:24.613370 IP 172.25.123.34.8726 &gt; ID-APP-USS-013.6080: Flags [.], ack 1, win 12, length 0
17:40:24.613379 IP 172.25.123.34.8726 &gt; ID-APP-USS-013.6080: Flags [P.], seq 1:404, ack 1, win 12, length 403
17:40:24.613384 IP ID-APP-USS-013.6080 &gt; 172.25.123.34.8726: Flags [.], ack 404, win 31, length 0
17:40:24.625293 IP ID-APP-USS-013.6080 &gt; 172.25.123.34.8726: Flags [P.], seq 1:309, ack 404, win 31, length 308
17:40:24.625385 IP ID-APP-USS-013.6080 &gt; 172.25.123.34.8726: Flags [F.], seq 309, ack 404, win 31, length 0
17:40:24.625398 IP 172.25.123.34.8726 &gt; ID-APP-USS-013.6080: Flags [.], ack 309, win 14, length 0
17:40:24.625446 IP 172.25.123.34.8726 &gt; ID-APP-USS-013.6080: Flags [F.], seq 404, ack 309, win 14, length 0
17:40:24.625451 IP ID-APP-USS-013.6080 &gt; 172.25.123.34.8726: Flags [.], ack 405, win 31, length 0
17:40:24.625561 IP 172.25.123.34.8726 &gt; ID-APP-USS-013.6080: Flags [.], ack 310, win 14, length 0
17:40:25.080885 IP 172.25.123.34.8966 &gt; ID-APP-USS-013.6080: Flags [S], seq 53001868, win 5840, options [mss 1460,nop,nop,sackOK,nop,wscale 9], length 0

&gt;
    13:29:11.563473 时间带有精确到微妙

    localhost.42333 &gt; localhost.9501 表示通信的流向，42333是客户端，9501是服务器端
    [S] 表示这是一个SYN请求
    [.] 表示这是一个ACK确认包，(client)SYN-&gt;(server)SYN-&gt;(client)ACK 就是3次握手过程
    [P] 表示这个是一个数据推送，可以是从服务器端向客户端推送，也可以从客户端向服务器端推
    [F] 表示这是一个FIN包，是关闭连接操作，client/server都有可能发起
    [R] 表示这是一个RST包，与F包作用相同，但RST表示连接关闭时，仍然有数据未被处理。可以理解为是强制切断连接
    win 342是指滑动窗口大小
    length 12指数据包的大小</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/15/tcpdump%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/15/tcpdump%E5%91%BD%E4%BB%A4/" class="post-title-link" itemprop="url">tcpdump命令</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-10-15 00:00:00 / Modified: 15:04:56" itemprop="dateCreated datePublished" datetime="2020-10-15T00:00:00+08:00">2020-10-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%91%BD%E4%BB%A4/" itemprop="url" rel="index"><span itemprop="name">命令</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="tcpdump"><a href="#tcpdump" class="headerlink" title="tcpdump"></a>tcpdump</h3><pre><code>tcpdump [-adeflnNOpqStvx][-c&lt;数据包数目&gt;][-dd][-ddd][-F&lt;表达文件&gt;][-i&lt;网络界面&gt;][-r&lt;数据包文件&gt;][-s&lt;数据包大小&gt;][-tt][-T&lt;数据包类型&gt;][-vv][-w&lt;数据包文件&gt;][输出数据栏位]

-c：指定要抓取的包数量；
-i interface：指定tcpdump需要监听的接口
-n：对地址以数字方式显式，否则显式为主机名，也就是说-n选项不做主机名解析。
-nn：除了-n的作用外，还把端口显示为数值，否则显示端口服务名。
-s: &lt;数据包大小&gt; 设置每个数据包的大小。
-N：不打印出host的域名部分。。
-P：指定要抓取的包是流入还是流出的包。可以给定的值为&quot;in&quot;、&quot;out&quot;和&quot;inout&quot;，默认为&quot;inout&quot;。
-s len：设置tcpdump的数据包抓取长度为len，如果不设置默认将会是65535字节。对于要抓取的数据包较大时，长度设置不够可能会产生包截断，若出现包截断，
-e：输出的每行中都将包括数据链路层头部信息，例如源MAC和目标MAC。
-q：快速打印输出。即打印很少的协议相关信息，从而输出行都比较简短。
-X：输出包的头部数据，会以16进制和ASCII两种方式同时输出。
-XX：输出包的头部数据，会以16进制和ASCII两种方式同时输出，更详细。
-v：当分析和打印的时候，产生详细的输出。
-vv：产生比-v更详细的输出。
-vvv：产生比-vv更详细的输出。
-w&lt;数据包文件&gt; 把数据包数据写入指定的文件。


host(缺省类型): 指明一台主机
net: 指明一个网络地址
port: 指明端口号
src: 指定网络源地址
dst: 指定目标网络地址；</code></pre>
<hr>
<h3 id="常见用法"><a href="#常见用法" class="headerlink" title="常见用法"></a>常见用法</h3><pre><code>tcpdump -i eth0 net 59.111.243.17
对网卡eth0进行抓包，并且只抓所有进入和离开网络地址59.111.243.17的包

tcpdump –i eth0 net 59.111.243.17 and src port 80
对网卡eth0进行抓包，并且只抓所有进入和离开网络地址59.111.243.17的包，且源端口号为80；

tcpdump -i eth0 net 59.111.243.17 -c 10000 -w temp.pcap
对网卡eth0进行抓包，并且只抓所有进入和离开网络地址59.111.243.17的包，抓包个数指定为10000个，并写入temp.pcap</code></pre>
<ul>
<li><p>对特定端口抓包</p>
<pre><code>  tcpdump host 172.25.123.34 |grep 6080</code></pre>
</li>
<li><p>对GET请求进行抓包</p>
</li>
</ul>
<pre><code>    sudo tcpdump -s 0 -A &#39;tcp dst port 80 and tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x47455420&#39;</code></pre>
<ul>
<li>对POST请求进行抓包</li>
</ul>
<pre><code>    sudo tcpdump -s 0 -A &#39;tcp dst port 80 and (tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x504f5354)&#39;</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/11/Nginx%E7%9B%B8%E5%BA%94%E6%97%B6%E9%97%B4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/11/Nginx%E7%9B%B8%E5%BA%94%E6%97%B6%E9%97%B4/" class="post-title-link" itemprop="url">查看Nginx相应时间</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-10-11 17:23:00 / Modified: 17:15:19" itemprop="dateCreated datePublished" datetime="2020-10-11T17:23:00+08:00">2020-10-11</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%91%BD%E4%BB%A4/" itemprop="url" rel="index"><span itemprop="name">命令</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="查看nginx-相应时间"><a href="#查看nginx-相应时间" class="headerlink" title="查看nginx 相应时间"></a>查看nginx 相应时间</h1><pre><code> cat -n  uss-access_2020-07-27.log |grep &#39;/validateWebauthnSt&#39;  |grep -o &#39;upstreamtime\&quot;:\&quot;[0-9]\.[0-9][0-9][0-9]&#39;|head -200

    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0
    upstreamtime&quot;:&quot;0</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/11/template/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/11/template/" class="post-title-link" itemprop="url">查看Nginx相应时间</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-10-11 17:23:00 / Modified: 17:16:47" itemprop="dateCreated datePublished" datetime="2020-10-11T17:23:00+08:00">2020-10-11</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%91%BD%E4%BB%A4/" itemprop="url" rel="index"><span itemprop="name">命令</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/11/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/11/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-10-11 14:23:00 / Modified: 17:11:22" itemprop="dateCreated datePublished" datetime="2020-10-11T14:23:00+08:00">2020-10-11</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">测试</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/10/11/%E3%80%8AOracle%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95%E8%AE%BA%E5%92%8C%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E3%80%8B-10.3.3-%E6%AD%BB%E9%94%81-%E5%A4%96%E9%94%AE%E5%BC%95%E5%8F%91%E6%AD%BB%E9%94%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/11/%E3%80%8AOracle%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95%E8%AE%BA%E5%92%8C%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E3%80%8B-10.3.3-%E6%AD%BB%E9%94%81-%E5%A4%96%E9%94%AE%E5%BC%95%E5%8F%91%E6%AD%BB%E9%94%81/" class="post-title-link" itemprop="url">《Oracle数据库性能优化方法论和最佳实践》-10.3.3-死锁-外键引发死锁</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-10-11 17:23:00" itemprop="dateCreated datePublished" datetime="2019-10-11T17:23:00+08:00">2019-10-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 17:18:23" itemprop="dateModified" datetime="2020-10-11T17:18:23+08:00">2020-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="背景知识"><a href="#背景知识" class="headerlink" title="背景知识"></a>背景知识</h1><blockquote>
<h6 id="外键由于业务规则内置在数据库中，开发人员很难注意到这种业务规则的存在会导致死锁概率的提升。外键约束会导致两个基本的场景：-一是删除主表时需要同步删除子表，即需要锁定子表的对应记录-。-二是插入子表需要确保主表记录存在，即需要锁定主表的对应记录。特别是当外键无索引时，Oracle会在子表上请求SX锁，这个锁和一般更新需要S锁不兼容，即只要子表有更新，就无法获得这个锁。也就是说，SSX使并发性控制从记录迁移到了表格上，从而使死锁发生的概率大幅度增加。"><a href="#外键由于业务规则内置在数据库中，开发人员很难注意到这种业务规则的存在会导致死锁概率的提升。外键约束会导致两个基本的场景：-一是删除主表时需要同步删除子表，即需要锁定子表的对应记录-。-二是插入子表需要确保主表记录存在，即需要锁定主表的对应记录。特别是当外键无索引时，Oracle会在子表上请求SX锁，这个锁和一般更新需要S锁不兼容，即只要子表有更新，就无法获得这个锁。也就是说，SSX使并发性控制从记录迁移到了表格上，从而使死锁发生的概率大幅度增加。" class="headerlink" title="外键由于业务规则内置在数据库中，开发人员很难注意到这种业务规则的存在会导致死锁概率的提升。外键约束会导致两个基本的场景：==一是删除主表时需要同步删除子表，即需要锁定子表的对应记录**==。**二是插入子表需要确保主表记录存在，即需要锁定主表的对应记录。特别是当外键无索引时，Oracle会在子表上请求SX锁，这个锁和一般更新需要S锁不兼容，即只要子表有更新，就无法获得这个锁。也就是说，SSX使并发性控制从记录迁移到了表格上，从而使死锁发生的概率大幅度增加。"></a>外键由于业务规则内置在数据库中，开发人员很难注意到这种业务规则的存在会导致死锁概率的提升。外键约束会导致两个基本的场景：==<em>一是删除主表时需要同步删除子表，即需要锁定子表的对应记录**</em>==。**二是插入子表需要确保主表记录存在，即需要锁定主表的对应记录。特别是当外键无索引时，Oracle会在子表上请求SX锁，这个锁和一般更新需要S锁不兼容，即只要子表有更新，就无法获得这个锁。也就是说，SSX使并发性控制从记录迁移到了表格上，从而使死锁发生的概率大幅度增加。</h6></blockquote>
<p>参考网址：</p>
<blockquote>
<pre><code>https://www.cnblogs.com/kerrycode/p/6723345.html
https://www.modb.pro/db/22800
https://blog.csdn.net/u013641333/article/details/82751111?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~first_rank_v2~rank_v25-2-82751111.nonecase
https://blog.csdn.net/zl834205311/article/details/81742691
https://cloud.tencent.com/developer/article/1451003
https://blog.csdn.net/hotdust/article/details/51258965</code></pre>
</blockquote>
<h1 id="Oracle锁"><a href="#Oracle锁" class="headerlink" title="Oracle锁"></a>Oracle锁</h1><p><img src="https://www.ibm.com/developerworks/cn/data/library/techarticles/dm-0512niuxzh/images/table2.gif" alt="image"></p>
<p><img src="https://www.ibm.com/developerworks/cn/data/library/techarticles/dm-0512niuxzh/images/table1.gif" alt="image"></p>
<h3 id="TM-锁（表级锁）"><a href="#TM-锁（表级锁）" class="headerlink" title="TM 锁（表级锁）"></a>TM 锁（表级锁）</h3><blockquote>
<p>TM 锁用于确保在修改表的内容时，表的结构不会改变，例如防止在 DML 语句执行期间相关的表被移除。当用户对表执行 DDL 或 DML 操作时，将获取一个此表的表级锁。</p>
<p>当事务获得行锁后，此事务也将自动获得该行的表锁(共享锁),以防止其它事务进行 DDL 语句影响记录行的更新。</p>
<p>事务也可以在进行过程中获得共享锁或排它锁，只有当事务显示使用 LOCK TABLE 语句显示的定义一个排它锁时，事务才会获得表上的排它锁,也可使用 LOCK TABLE 显示的定义一个表级的共享锁。</p>
<p>TM 锁包括了 SS、 SX、 S、 X 等多种模式，在数据库中用 0－6 来表示。不同的 SQL 操作产生不同类型的 TM 锁.</p>
</blockquote>
<p>TM 锁类型表<br><img src="http://images2015.cnblogs.com/blog/824142/201612/824142-20161222210536948-1062959696.png" alt="image"></p>
<h2 id="Oracle的TX锁（行级锁、事务锁）"><a href="#Oracle的TX锁（行级锁、事务锁）" class="headerlink" title="Oracle的TX锁（行级锁、事务锁）"></a>Oracle的TX锁（行级锁、事务锁）</h2><blockquote>
<p>许多对Oracle不太了解的技术人员可能会以为每一个TX锁代表一条被封锁的数据行，其实不然。TX的本义是Transaction（事务），当 一个事务第一次执行数据更改（Insert、Update、Delete）或使用SELECT… FOR UPDATE语句进行查询时，它即获得一个TX（事务）锁，直至该事务结束（执行COMMIT或ROLLBACK操作）时，该锁才被释放。所以，一个TX 锁，可以对应多个被该事务锁定的数据行（在我们用的时候多是启动一个事务，然后SELECT… FOR UPDATE NOWAIT）。</p>
<p>在Oracle的每行数据上，都有一个标志位来表示该行数据是否被锁定。Oracle不像DB2那样，建立一个链表来维护每一行被加锁的数据，这样 就大大减小了行级锁的维护开销，也在很大程度上避免了类似DB2使用行级锁时经常发生的锁数量不够而进行锁升级的情况。数据行上的锁标志一旦被置位，就表 明该行数据被加X锁，Oracle在数据行上没有S锁。</p>
</blockquote>
<h1 id="死锁"><a href="#死锁" class="headerlink" title="死锁"></a>死锁</h1><blockquote>
<p>==外键未加索引是引发死锁的一大原因。更新父表的主键或者删除父表中的一行都会导致子表产生一个全表锁</p>
<p>  ==<strong>删除主表会自动在字表上追加S锁,但是S锁和RX锁不兼容所以sql会被阻塞</strong>）==。</p>
</blockquote>
<h1 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h1><blockquote>
<pre><code>建立主表
create table PK_TEST
(
  ID   NUMBER not null
    constraint PK_TEST_PK
      primary key,
  NAME VARCHAR2(20)
)
/</code></pre>
</blockquote>
<blockquote>
<pre><code>建立字表
create table FK_TEST
(
  ID   NUMBER not null
    constraint FK_TEST_PK
      primary key,
  NAME VARCHAR2(20),
  PID  NUMBER
    constraint FK_TEST_PK_TEST_ID_FK
      references PK_TEST
        on delete cascade
)
/</code></pre>
</blockquote>
<ul>
<li>情况1：==session1删除主表不提交，session2删除/ 更新=子表应用的主表的字段时，insert新记录都被阻塞==</li>
</ul>
<pre><code>    1.session1中删除一个主表记录，不提交
    2.session2中删除一个字表记录，session被阻塞
    因为删除主表记录时，会自动在字表上申请S锁，此时申请成功，
    当删除字表时事务会在字表上申请RX锁（insert，update，delete）
    但是之前申请的S锁和RX锁不兼容，因此Session2阻塞。</code></pre>
<ul>
<li>情况2：Session1删除子表不提交，Session2删除主表被阻塞</li>
</ul>
<pre><code>    1.session1删除一个字表记录，不提交
    2.session2删除一个主表记录，此时session2被阻塞
    因为删除字表，事务自动申请字表RX锁，同时申请被删除行的TX锁，当session2
    删除主表记录时，事务自动申请被关联的字表的S锁，但是此时session1中已经持有过了RX锁，因此申请S锁失败，session2被阻塞。</code></pre>
<ul>
<li><p>情况3：session1子表插入记录不提交，session2阻塞主表插入操作。</p>
<pre><code>  本地实验未能成功复现</code></pre>
</li>
<li><p>情况4：session1插入子表不提交，session2删除主表任意字段被阻塞。</p>
</li>
</ul>
<ul>
<li>==删除账号导致死锁的实验分析==</li>
</ul>
<pre><code>    1.session1 删除子表（时间长，执行慢），删除主表。此时执行缓慢，新开一个session
    2.session2 重复之前动作
    3.session3 重复之前动作，此时系统已经发生死锁，因为没有回滚机制，导致一直死锁。</code></pre>
<h4 id="查看整个数据库下拥有主外键关系的所有表（排除一些系统用户）"><a href="#查看整个数据库下拥有主外键关系的所有表（排除一些系统用户）" class="headerlink" title="# 查看整个数据库下拥有主外键关系的所有表（排除一些系统用户）"></a># 查看整个数据库下拥有主外键关系的所有表（排除一些系统用户）</h4><pre><code>    SELECT DC.OWNER                   AS &quot;PARENT_TABLE_OWNER&quot;, 
                 DC.TABLE_NAME              AS &quot;PARENT_TABLE_NAME&quot;, 
                 DC.CONSTRAINT_NAME         AS &quot;PRIMARY CONSTRAINT NAME&quot;, 
                 DF.CONSTRAINT_NAME         AS &quot;REFERENCED CONSTRAINT NAME&quot;, 
                 DF.OWNER                   AS &quot;CHILD_TABLE_OWNER&quot;, 
                 DF.TABLE_NAME              AS &quot;CHILD_TABLE_NAME&quot; 
    FROM   DBA_CONSTRAINTS DC, 
                 (SELECT C.OWNER, 
                                 C.CONSTRAINT_NAME, 
                                 C.R_CONSTRAINT_NAME, 
                                 C.TABLE_NAME 
                    FROM   DBA_CONSTRAINTS C 
                    WHERE  CONSTRAINT_TYPE = &#39;R&#39;) DF 
    WHERE  DC.CONSTRAINT_NAME =DF.R_CONSTRAINT_NAME 
                 AND DC.OWNER NOT IN ( &#39;SYSTEM&#39;, &#39;SYS&#39;, &#39;DBSNMP&#39;, &#39;EXFSYS&#39;, 
                                                            &#39;ORDDATA&#39;, &#39;CTXSYS&#39;, &#39;OLAPSYS&#39;, &#39;MDSYS&#39;, 
                                                            &#39;SYSMAN&#39; ); </code></pre>
<h4 id="–查看某个Schema下拥有主外键关系的所有表"><a href="#–查看某个Schema下拥有主外键关系的所有表" class="headerlink" title="–查看某个Schema下拥有主外键关系的所有表"></a>–查看某个Schema下拥有主外键关系的所有表</h4><pre><code>    SELECT DC.OWNER           AS &quot;PARENT_TABLE_OWNER&quot;, 
                 DC.TABLE_NAME      AS &quot;PARENT_TABLE_NAME&quot;, 
                 DC.CONSTRAINT_NAME AS &quot;PRIMARY CONSTRAINT NAME&quot;, 
                 DF.CONSTRAINT_NAME AS &quot;REFERENCED CONSTRAINT NAME&quot;, 
                 DF.OWNER           AS &quot;CHILD_TABLE_OWNER&quot;, 
                 DF.TABLE_NAME      AS &quot;CHILD_TABLE_NAME&quot; 
    FROM   DBA_CONSTRAINTS DC, 
                 (SELECT C.OWNER, 
                                 C.CONSTRAINT_NAME, 
                                 C.R_CONSTRAINT_NAME, 
                                 C.TABLE_NAME 
                    FROM   DBA_CONSTRAINTS C 
                    WHERE  CONSTRAINT_TYPE = &#39;R&#39;) DF 
    WHERE  DC.CONSTRAINT_NAME = DF.R_CONSTRAINT_NAME 
                 AND DC.OWNER =UPPER(&#39;&amp;OWNER&#39;);  </code></pre>
<h4 id="–查看某个具体的表是否和其它表拥有主外键关系"><a href="#–查看某个具体的表是否和其它表拥有主外键关系" class="headerlink" title="–查看某个具体的表是否和其它表拥有主外键关系"></a>–查看某个具体的表是否和其它表拥有主外键关系</h4><pre><code>    SELECT DC.OWNER           AS &quot;PARENT_TABLE_OWNER&quot;, 
                 DC.TABLE_NAME      AS &quot;PARENT_TABLE_NAME&quot;, 
                 DC.CONSTRAINT_NAME AS &quot;PRIMARY CONSTRAINT NAME&quot;, 
                 DF.CONSTRAINT_NAME AS &quot;REFERENCED CONSTRAINT NAME&quot;, 
                 DF.OWNER           AS &quot;CHILD_TABLE_OWNER&quot;, 
                 DF.TABLE_NAME      AS &quot;CHILD_TABLE_NAME&quot; 
    FROM   DBA_CONSTRAINTS DC, 
                 (SELECT C.OWNER, 
                                 C.CONSTRAINT_NAME, 
                                 C.R_CONSTRAINT_NAME, 
                                 C.TABLE_NAME 
                    FROM   DBA_CONSTRAINTS C 
                    WHERE  CONSTRAINT_TYPE = &#39;R&#39;) DF 
    WHERE  DC.CONSTRAINT_NAME = DF.R_CONSTRAINT_NAME 
                 AND DC.OWNER =UPPER(&#39;&amp;OWNER&#39;)
                 AND DC.TABLE_NAME=UPPER(&#39;&amp;TABLE_NAME&#39;);</code></pre>
<h4 id="接下来我们要找出在具体的外键字段是否有索引，脚本如下所示："><a href="#接下来我们要找出在具体的外键字段是否有索引，脚本如下所示：" class="headerlink" title="接下来我们要找出在具体的外键字段是否有索引，脚本如下所示："></a>接下来我们要找出在具体的外键字段是否有索引，脚本如下所示：</h4><pre><code>    SELECT   CON.OWNER ,
                     CON.TABLE_NAME,
                     CON.CONSTRAINT_NAME,
                     CON.COL_LIST,
                     &#39;No Indexed&#39; AS INDEX_STATUS
    FROM
             (SELECT CC.OWNER, CC.TABLE_NAME, CC.CONSTRAINT_NAME,
                         MAX(DECODE(POSITION, 1,     &#39;&quot;&#39; ||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 2,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 3,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 4,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 5,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 6,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 7,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 8,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 9,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 10,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) COL_LIST
                         FROM DBA_CONSTRAINTS DC, DBA_CONS_COLUMNS CC
                         WHERE DC.OWNER = CC.OWNER
                         AND DC.CONSTRAINT_NAME = CC.CONSTRAINT_NAME
                         AND DC.CONSTRAINT_TYPE = &#39;R&#39;
                         AND DC.OWNER NOT IN (&#39;SYS&#39;, &#39;SYSTEM&#39;, &#39;OLAPSYS&#39;, &#39;SYSMAN&#39;, &#39;MDSYS&#39;, &#39;ADMIN&#39;)
                         GROUP BY CC.OWNER, CC.TABLE_NAME, CC.CONSTRAINT_NAME 
             ) CON
                WHERE NOT EXISTS (
                    SELECT 1 FROM
                                        ( SELECT TABLE_OWNER, TABLE_NAME,   
                                                 MAX(DECODE(COLUMN_POSITION, 1,     &#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 2,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 3,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 4,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 5,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 6,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 7,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 8,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 9,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 10,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) COL_LIST
                                                 FROM DBA_IND_COLUMNS 
                                         WHERE TABLE_OWNER NOT IN (&#39;SYS&#39;, &#39;SYSTEM&#39;, &#39;OLAPSYS&#39;, &#39;SYSMAN&#39;, &#39;MDSYS&#39;)
                                         GROUP BY TABLE_OWNER, TABLE_NAME, INDEX_NAME ) COL
            WHERE CON.OWNER = COL.TABLE_OWNER 
            AND CON.TABLE_NAME = COL.TABLE_NAME  
            AND CON.COL_LIST = SUBSTR(COL.COL_LIST, 1, LENGTH(CON.COL_LIST) ) )  ;  </code></pre>
<h4 id="如果是ORACLE-11g或以上版本，数据库有分析函数LISTAGG的话，可以使用下面脚本"><a href="#如果是ORACLE-11g或以上版本，数据库有分析函数LISTAGG的话，可以使用下面脚本" class="headerlink" title="如果是ORACLE 11g或以上版本，数据库有分析函数LISTAGG的话，可以使用下面脚本"></a>如果是ORACLE 11g或以上版本，数据库有分析函数LISTAGG的话，可以使用下面脚本</h4><pre><code>    SELECT CASE 
                     WHEN B.TABLE_NAME IS NULL THEN &#39;NO INDEXED&#39; 
                     ELSE &#39;INDEXED&#39; 
                 END               AS STATUS, 
                 A.TABLE_OWNER     AS TABLE_OWNER, 
                 A.TABLE_NAME      AS TABLE_NAME, 
                 A.CONSTRAINT_NAME AS FK_NAME, 
                 A.FK_COLUMNS      AS FK_COLUMNS, 
                 B.INDEX_NAME      AS INDEX_NAME, 
                 B.INDEX_COLUMNS   AS INDEX_COLUMNS 
    FROM   (SELECT A.OWNER                              AS TABLE_OWNER, 
                                 A.TABLE_NAME                         AS TABLE_NAME, 
                                 A.CONSTRAINT_NAME                    AS CONSTRAINT_NAME, 
                                 LISTAGG(A.COLUMN_NAME, &#39;,&#39;) 
                                     WITHIN GROUP (ORDER BY A.POSITION) FK_COLUMNS 
                    FROM   DBA_CONS_COLUMNS A, 
                                 DBA_CONSTRAINTS B 
                    WHERE  A.CONSTRAINT_NAME = B.CONSTRAINT_NAME 
                                 AND B.CONSTRAINT_TYPE = &#39;R&#39; 
                                 AND A.OWNER = B.OWNER 
                                 AND A.OWNER NOT IN ( &#39;SYS&#39;, &#39;SYSTEM&#39;, &#39;OLAPSYS&#39;, &#39;SYSMAN&#39;, 
                                                                            &#39;MDSYS&#39; ) 
                    GROUP  BY A.OWNER, 
                                        A.TABLE_NAME, 
                                        A.CONSTRAINT_NAME) A, 
                 (SELECT TABLE_OWNER, 
                                 TABLE_NAME, 
                                 INDEX_NAME, 
                                 LISTAGG(C.COLUMN_NAME, &#39;,&#39;) 
                                     WITHIN GROUP (ORDER BY C.COLUMN_POSITION) INDEX_COLUMNS 
                    FROM   DBA_IND_COLUMNS C 
                    GROUP  BY TABLE_OWNER, 
                                        TABLE_NAME, 
                                        INDEX_NAME) B 
    WHERE  A.TABLE_NAME = B.TABLE_NAME(+) 
         AND A.TABLE_OWNER = B.TABLE_OWNER(+) 
         AND B.INDEX_COLUMNS(+) LIKE A.FK_COLUMNS 
                                                                 || &#39;%&#39; 
    ORDER  BY 1 DESC

            /*******************************************************************************************
    --脚本功能描述：
    --  对于数据库中外键缺少索引的字段，生成对应的索引（排除一些系统账号，例如sys、system）,如果外键索引超过十个字段
    --  那么这个脚本就不能正确的生成对应的索引，当然也很少有外键设置在超过10个字段的。另外索引表空
    --  空间跟数据表空间相同，如有分开的话，建议在此处再做调整。
    ********************************************************************************************/
    SELECT    &#39;CREATE INDEX &#39; || OWNER || &#39;.&#39; || REPLACE(CONSTRAINT_NAME,&#39;FK_&#39;,&#39;IX_&#39;) || 
                    &#39; ON &#39; || OWNER || &#39;.&#39; || TABLE_NAME || &#39; (&#39; || COL_LIST ||&#39;) TABLESPACE &#39; 
                    || (SELECT TABLESPACE_NAME FROM DBA_TABLES WHERE OWNER= CON.OWNER AND TABLE_NAME= CON.TABLE_NAME) 
                    AS  CREATE_INDEXES_ON_FOREIGN_KEY 
    FROM
             (SELECT CC.OWNER, CC.TABLE_NAME, CC.CONSTRAINT_NAME,
                         MAX(DECODE(POSITION, 1,     &#39;&quot;&#39; ||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 2,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 3,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 4,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 5,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 6,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 7,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 8,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 9,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) ||
                         MAX(DECODE(POSITION, 10,&#39;, &#39;||&#39;&quot;&#39;||
                                        SUBSTR(COLUMN_NAME,1,30) ||&#39;&quot;&#39;,NULL)) COL_LIST
                         FROM DBA_CONSTRAINTS DC, DBA_CONS_COLUMNS CC
                         WHERE DC.OWNER = CC.OWNER
                         AND DC.CONSTRAINT_NAME = CC.CONSTRAINT_NAME
                         AND DC.CONSTRAINT_TYPE = &#39;R&#39;
                         AND DC.OWNER NOT IN (&#39;SYS&#39;, &#39;SYSTEM&#39;, &#39;OLAPSYS&#39;, &#39;SYSMAN&#39;, &#39;MDSYS&#39;, &#39;ADMIN&#39;)
                         GROUP BY CC.OWNER, CC.TABLE_NAME, CC.CONSTRAINT_NAME 
             ) CON
                WHERE NOT EXISTS (
                    SELECT 1 FROM
                                        ( SELECT TABLE_OWNER, TABLE_NAME,   
                                                 MAX(DECODE(COLUMN_POSITION, 1,     &#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 2,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 3,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 4,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 5,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 6,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 7,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 8,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 9,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) ||
                                                 MAX(DECODE(COLUMN_POSITION, 10,&#39;, &#39;||&#39;&quot;&#39;||
                                                                SUBSTR(COLUMN_NAME,1,30)  ||&#39;&quot;&#39;,NULL)) COL_LIST
                                                 FROM DBA_IND_COLUMNS 
                                         WHERE TABLE_OWNER NOT IN (&#39;SYS&#39;, &#39;SYSTEM&#39;, &#39;OLAPSYS&#39;, &#39;SYSMAN&#39;, &#39;MDSYS&#39;)
                                         GROUP BY TABLE_OWNER, TABLE_NAME, INDEX_NAME ) COL
            WHERE CON.OWNER = COL.TABLE_OWNER 
            AND CON.TABLE_NAME = COL.TABLE_NAME  
            AND CON.COL_LIST = SUBSTR(COL.COL_LIST, 1, LENGTH(CON.COL_LIST) ) )  ; 

                    --脚本使用分析函数LISTAGG， 适用于ORACLE 11g以及以上版本，如果数据库版本是Oracle 11g及以上，就可以使用此脚本替代上面脚本。

    SELECT &#39;CREATE INDEX &#39; 
                                || OWNER 
                                || &#39;.&#39; 
                                || REPLACE(CONSTRAINT_NAME,&#39;FK_&#39;,&#39;IX_&#39;) 
                                || &#39; ON &#39; 
                                || OWNER 
                                || &#39;.&#39; 
                                || TABLE_NAME 
                                || &#39; (&#39; 
                                || FK_COLUMNS 
                                ||&#39;) TABLESPACE &#39; 
                                || 
                 ( 
                                SELECT TABLESPACE_NAME 
                                FROM   DBA_TABLES 
                                WHERE  OWNER= CON.OWNER 
                                AND    TABLE_NAME= CON.TABLE_NAME) CREATE_INDEXES_ON_FOREIGN_KEY 
    FROM   ( 
                                    SELECT   CC.OWNER, 
                                                     CC.TABLE_NAME, 
                                                     CC.CONSTRAINT_NAME, 
                                                     LISTAGG(CC.COLUMN_NAME, &#39;,&#39;) WITHIN GROUP (ORDER BY CC.POSITION) FK_COLUMNS
                                    FROM     DBA_CONS_COLUMNS CC, 
                                                     DBA_CONSTRAINTS DC 
                                    WHERE    CC.CONSTRAINT_NAME = DC.CONSTRAINT_NAME 
                                    AND      DC.CONSTRAINT_TYPE = &#39;R&#39; 
                                    AND      CC.OWNER = DC.OWNER 
                                    AND      DC.OWNER NOT IN ( &#39;SYS&#39;, 
                                                                                        &#39;SYSTEM&#39;, 
                                                                                        &#39;OLAPSYS&#39;, 
                                                                                        &#39;SYSMAN&#39;, 
                                                                                        &#39;MDSYS&#39;, 
                                                                                        &#39;ADMIN&#39; ) 
                                    GROUP BY CC.OWNER, 
                                                     CC.TABLE_NAME, 
                                                     CC.CONSTRAINT_NAME) CON 
        WHERE NOT EXISTS 
                 ( 
                                SELECT 1 
                                FROM   ( 
                                                                SELECT   TABLE_OWNER, 
                                                                                 TABLE_NAME, 
                                                                                 INDEX_NAME,
                                                                                 LISTAGG(COLUMN_NAME, &#39;,&#39;) WITHIN GROUP (ORDER BY COLUMN_POSITION) FK_COLUMNS
                                                                FROM     DBA_IND_COLUMNS 
                                                                WHERE    INDEX_OWNER NOT IN ( &#39;SYS&#39;, 
                                                                                                                         &#39;SYSTEM&#39;, 
                                                                                                                         &#39;OLAPSYS&#39;, 
                                                                                                                         &#39;SYSMAN&#39;, 
                                                                                                                         &#39;MDSYS&#39;, 
                                                                                                                         &#39;ADMIN&#39; ) 

                                                                GROUP BY TABLE_OWNER, 
                                                                                 TABLE_NAME ,INDEX_NAME) COL 
                                WHERE  CON.OWNER = COL.TABLE_OWNER 
                                AND    CON.TABLE_NAME = COL.TABLE_NAME 
                                AND    CON.FK_COLUMNS = SUBSTR(COL.FK_COLUMNS, 1, LENGTH(CON.FK_COLUMNS)) ) 
                                ORDER BY 1;</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
